<!doctype html><html lang=en class=no-js><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><link rel=icon href=/fav.ico type=image/gif><link rel=apple-touch-icon href=/fav.png><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><meta property="og:url" content="https://kovasky.me/blogs/sr_iov/"><meta property="og:site_name" content="Kovasky Buezo | Software Developer, Cybersecurity Enthusiast"><meta property="og:title" content="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"><meta property="og:description" content="Enabling SR-IOV for an Intel X540-T2 on a Dell Poweredge T440 running Proxmox 8."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2024-08-12T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-12T00:00:00+00:00"><meta property="article:tag" content="Dell"><meta property="article:tag" content="Intel"><meta property="article:tag" content="NIC"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Proxmox"><meta name=twitter:card content="summary"><meta name=twitter:title content="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"><meta name=twitter:description content="Enabling SR-IOV for an Intel X540-T2 on a Dell Poweredge T440 running Proxmox 8."><link rel=stylesheet href=/css/style.min.158dcc300e62be6d3e0b8f0abf504241048e72a0598013be932912f9a9e4e94c.css integrity="sha256-FY3MMA5ivm0+C48Kv1BCQQSOcqBZgBO+kykS+ank6Uw="><script src=https://kovasky.me/js/scripts.2d23e8962f1d048364da76fc5bffdcbf2a7565614d019068b65ebdba8c9d0d72.js integrity="sha256-LSPoli8dBINk2nb8W//cvyp1ZWFNAZBotl69uoydDXI=" async></script><script src=https://kovasky.me/lazyimg/lazysizes/lazysizes.min.js async></script><link rel=preload href=/blogs/sr_iov/images/iperf.webp as=image fetchpriority=high><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{background-color:var(--background-color)!important}body::-webkit-scrollbar{height:0;width:8px;background-color:var(--background-color)}::-webkit-scrollbar-track{border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background:#b0b0b0;outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content="Enabling SR-IOV for an Intel X540-T2 on a Dell Poweredge T440 running Proxmox 8."><meta property="og:image" content="images/iperf.webp"><title>Enabling SR-IOV for an Intel X540-T2 on Proxmox 8</title></head><body class="light dark"><script>document.documentElement.className="js"</script><script>let localStorageValue=localStorage.getItem("pref-theme"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(localStorageValue){case"dark":document.body.classList.add("dark");break;case"light":document.body.classList.remove("dark");break;default:mediaQuery&&document.body.classList.add("dark");break}</script><script>var prevScrollPos=window.pageYOffset;window.addEventListener("scroll",function(){let s=document.getElementById("profileHeader"),t=window.pageYOffset,n=!1,o=!1,i=o?prevScrollPos>t:t>0;i?s.classList.add("showHeaderOnTop"):n=!0,t===0&&(n=!0),n&&s.classList.remove("showHeaderOnTop"),prevScrollPos=t})</script><header id=profileHeader><nav class="pt-3 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/fav.ico width=30 height=30 class="d-inline-block align-top" alt=favicon>
Kovasky Buezo</a><div><input id=search autocomplete=off class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl + k to Search...' aria-label=Search></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation">
<svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text d-block d-md-none"><div class=nav-link><input id=search autocomplete=off class="form-control mr-sm-2" placeholder='Ctrl + k to Search...' aria-label=Search></div></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About Me</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#achievements aria-label=achievements>Credentials</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Projects</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link title="ðŸ‡¨ðŸ‡¦  English">ðŸ‡¨ðŸ‡¦ English</a></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">Enabling SR-IOV for an Intel X540-T2 on Proxmox 8</h1><div class=text-center>Kovasky Buezo
<small>|</small>
Aug 12, 2024
<span id=readingTime>min read</span></div><div class=text-center></div></div><div class=featured-image><noscript><img src=/images/lazyimg/iperf-1024x.webp class="img-fluid mx-auto d-block" loading=lazy height=856 width=1024 srcset="/images/lazyimg/iperf-270x.webp 270w,
/images/lazyimg/iperf-420x.webp 420w,
/images/lazyimg/iperf-570x.webp 570w,
/images/lazyimg/iperf-720x.webp 720w,
/images/lazyimg/iperf-1024x.webp 1024w" alt="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"></noscript><img src=/images/lazyimg/iperf-120x%20Gaussian.webp data-src=/images/lazyimg/iperf-1024x.webp class="img-fluid mx-auto d-block blur-up lazyload" height=856 width=1024 data-sizes=auto data-srcset="/images/lazyimg/iperf-270x.webp 270w,
/images/lazyimg/iperf-420x.webp 420w,
/images/lazyimg/iperf-570x.webp 570w,
/images/lazyimg/iperf-720x.webp 720w,
/images/lazyimg/iperf-1024x.webp 1024w" alt="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"></div><article class="page-content p-2"><h2 id=intro>Intro</h2><p>In the quest to get more performance out of my inter-vm communication, I stumbled upon SR-IOV and virtual functions. I then purchased a 10gbe X540-T2 from a Chinese seller on eBay making sure to get one with a fan, as reports of this specific card say it runs quite hot. After setting everything up, I increased my network performance from 2.5gbps on a vSwitch to 14gbps with virtual function passthrough.</p><h2 id=pre-requisites>Pre-requisites</h2><p>Before proceeding, make sure to enable IOMMU by editing <code>/etc/default/grub</code> and replacing the <code>GUB_CMDLINE_LINUX_DEFAULT</code> lines as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GRUB_CMDLINE_LINUX_DEFAULT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;quiet intel_iommu=on iommu=pt&#34;</span></span></span></code></pre></div><p>Once the edit is in place, run the command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>update grub</span></span></code></pre></div><p>Now, you have to enable some VFIO modules by editing the file <code>/etc/modules</code> and adding these lines at the end of the file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vfio
</span></span><span style=display:flex><span>vfio_iommu_type1
</span></span><span style=display:flex><span>vfio_pci
</span></span><span style=display:flex><span>vfio_virqfd</span></span></code></pre></div><p>To make sure these modules are loaded on the next boot you have to issue the command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>update-initramfs -u -k all</span></span></code></pre></div><p>All that is left is to reboot the system to make sure IOMMU and corresponding VFIO modules are enabled.</p><h2 id=testing-sr-iov>Testing SR-IOV</h2><p>Before issuing the commands to enable SR-IOV, you need to find out which network interfaces are associated with the network card. There are several approaches to this, including using the web GUI. In my case, I just issued the command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dmesg | grep eth</span></span></code></pre></div><p>Then, I looked for lines that resemble the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>    4.602387<span style=color:#f92672>]</span> ixgbe 0000:5f:00.0 ens5f0: renamed from eth0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>    4.686386<span style=color:#f92672>]</span> ixgbe 0000:5f:00.1 ens5f1: renamed from eth1</span></span></code></pre></div><p>An easy way to test out SR-IOV is to issue the command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo N &gt; /sys/class/net/&lt;NIC&gt;/device/sriov_numvfs</span></span></code></pre></div><p>In my case, the command would look something like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#ae81ff>2</span> &gt; /sys/class/net/ens5f1/device/sriov_numvfs</span></span></code></pre></div><p>To make sure this is working, you can issue <code>ip link show NIC</code> and if everything is working as it should the output should be something similar to this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@pve:~# ip link show ens5f1
</span></span><span style=display:flex><span>5: ens5f1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>9000</span> qdisc mq state UP mode DEFAULT group default qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span> link/ether XX:XX:XX:XX:XX:XX brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span> vf <span style=color:#ae81ff>0</span>     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking on, link-state auto, trust off, query_rss off
</span></span><span style=display:flex><span> vf <span style=color:#ae81ff>1</span>     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking on, link-state auto, trust off, query_rss off
</span></span><span style=display:flex><span> altname enp95s0f1</span></span></code></pre></div><h2 id=automating-the-virtual-function-generation>Automating the virtual function generation</h2><p>The changes performed in the previous step are not saved across reboots. To circumvent this, you can create a systemd service that runs on boot and tells the system to create the virtual functions as well as assign a MAC address to them. You need to create and edit the file <code>/etc/systemd/system/sriov_nic.service</code>. It should contain something similar to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Description<span style=color:#f92672>=</span>Enables SR-IOV and assigns MAC Addresses to the virtual functions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>oneshot
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/usr/bin/bash -c <span style=color:#e6db74>&#39;/usr/bin/echo 2 &gt; /sys/class/net/ens5f1/device/sriov_numvfs&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/usr/bin/bash -c <span style=color:#e6db74>&#39;/usr/bin/ip link set ens5f1 vf 0 mac 82:ea:27:28:e8:d5&#39;</span>
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/usr/bin/bash -c <span style=color:#e6db74>&#39;/usr/bin/ip link set ens5f1 vf 1 mac 6e:e2:6a:a8:99:64&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>WantedBy<span style=color:#f92672>=</span>multi-user.target</span></span></code></pre></div><p>After the file is created, you need to run <code>systemctl daemon-reload</code> and then <code>systemctl enable --now sriov_nic</code> to start the service at every boot."</p><h2 id=autostarting-the-network-cards>Autostarting the Network Cards</h2><p>It&rsquo;s important to note that the physical NIC needs to be set to autostart; otherwise, the creation of virtual functions will fail. To do this navigate to the web GUI and under network, click edit on the appropriate card, tick the box autostart, and click on ok to apply the changes.</p><h2 id=assign-virtual-functions-to-vms>Assign Virtual Functions to VMs</h2><p>To assign the virtual functions to the VMs, you first need to blacklist the driver so that the host does not take control of them. To do this you need to edit <code>/etc/modprobe.d/pve-blacklist.conf</code> and add the following line at the end of the file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>blacklist ixgbevf</span></span></code></pre></div><p>Then you have to run <code>update-initramfs -u -k all</code> to make sure the changes are applied on every boot.</p><p>Next, proceed to your chosen VM, and click on hardware -> Add -> PCI Device. Here, click on Raw Device and select a virtual function. Make sure that the options ROM-Bar is selected and PCI-Express is unselected.</p><picture><source type=image/webp srcset=/images/lazyimg/pci_device-120x%20Gaussian.webp height=481 width=920 data-sizes=auto data-srcset="/images/lazyimg/pci_device-270x.webp 270w,
/images/lazyimg/pci_device-420x.webp 420w,
/images/lazyimg/pci_device-570x.webp 570w,
/images/lazyimg/pci_device-720x.webp 720w,
/images/lazyimg/pci_device-920x.webp 920w"><noscript><img src=/images/lazyimg/pci_device-920x.webp loading=lazy height=481 width=920 srcset="/images/lazyimg/pci_device-270x.webp 270w,
/images/lazyimg/pci_device-420x.webp 420w,
/images/lazyimg/pci_device-570x.webp 570w,
/images/lazyimg/pci_device-720x.webp 720w,
/images/lazyimg/pci_device-920x.webp 920w" alt="pci device selection screen with virtual functions"></noscript><img src=/images/lazyimg/pci_device-120x%20Gaussian.webp data-src=/images/lazyimg/pci_device-920x.webp class="blur-up lazyload" height=481 width=920 data-sizes=auto data-srcset="/images/lazyimg/pci_device-270x.webp 270w,
/images/lazyimg/pci_device-420x.webp 420w,
/images/lazyimg/pci_device-570x.webp 570w,
/images/lazyimg/pci_device-720x.webp 720w,
/images/lazyimg/pci_device-920x.webp 920w" alt="pci device selection screen with virtual functions"></picture><h2 id=windows-hosts>Windows hosts</h2><p>In my case, the network card was not automatically detected by my Windows Server 2019 VM. I had to download the appropriate drivers for my setup, which can be found <a href=https://www.intel.com/content/www/us/en/download/19372/intel-network-adapter-driver-for-windows-server-2019.html>here</a>.</p><h2 id=done>Done!</h2><p>Once everything is set up, you will be able to benefit from network hardware acceleration!</p><hr><div id=load_comments style=text-align:center;display:block><button onclick=toggleComments()>
<span class="icon fa-solid fa-comments"><svg viewBox="0 0 640 512"><path d="M208 352c114.9.0 208-78.8 208-176S322.9.0 208 0 0 78.8.0 176c0 38.6 14.7 74.3 39.6 103.4-3.5 9.4-8.7 17.7-14.2 24.7-4.8 6.2-9.7 11-13.3 14.3-1.8 1.6-3.3 2.9-4.3 3.7-.5.4-.9.7-1.1.8l-.2.2C1 327.2-1.4 334.4.8 340.9S9.1 352 16 352c21.8.0 43.8-5.6 62.1-12.5 9.2-3.5 17.8-7.4 25.3-11.4C134.1 343.3 169.8 352 208 352zM448 176c0 112.3-99.1 196.9-216.5 207C255.8 457.4 336.4 512 432 512c38.2.0 73.9-8.7 104.7-23.9 7.5 4 16 7.9 25.2 11.4 18.3 6.9 40.3 12.5 62.1 12.5 6.9.0 13.1-4.5 15.2-11.1s-.2-13.8-5.8-17.9l-.2-.2c-.2-.2-.6-.4-1.1-.8-1-.8-2.5-2-4.3-3.7-3.6-3.3-8.5-8.1-13.3-14.3-5.5-7-10.7-15.4-14.2-24.7 24.9-29 39.6-64.7 39.6-103.4.0-92.8-84.9-168.9-192.6-175.5.4 5.1.6 10.3.6 15.5z"/></svg></span>
View Comments</button></div><h2 id=comments_header style=display:none>Comments</h2><div id=cusdis_thread data-host=https://cusdis.com data-app-id=fdd898fc-afd5-4280-9cb3-6dd7a1a05e17 data-page-id=https://kovasky.me/blogs/sr_iov/ data-page-url=https://kovasky.me/blogs/sr_iov/ data-page-title="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8" data-theme=dark style=min-height:50vh;display:none;resize:vertical;overflow:auto></div><div id=hide_comments style=text-align:center;display:none><br><button onclick=toggleComments()>
<span class="icon fa-solid fa-comments"><svg viewBox="0 0 640 512"><path d="M208 352c114.9.0 208-78.8 208-176S322.9.0 208 0 0 78.8.0 176c0 38.6 14.7 74.3 39.6 103.4-3.5 9.4-8.7 17.7-14.2 24.7-4.8 6.2-9.7 11-13.3 14.3-1.8 1.6-3.3 2.9-4.3 3.7-.5.4-.9.7-1.1.8l-.2.2C1 327.2-1.4 334.4.8 340.9S9.1 352 16 352c21.8.0 43.8-5.6 62.1-12.5 9.2-3.5 17.8-7.4 25.3-11.4C134.1 343.3 169.8 352 208 352zM448 176c0 112.3-99.1 196.9-216.5 207C255.8 457.4 336.4 512 432 512c38.2.0 73.9-8.7 104.7-23.9 7.5 4 16 7.9 25.2 11.4 18.3 6.9 40.3 12.5 62.1 12.5 6.9.0 13.1-4.5 15.2-11.1s-.2-13.8-5.8-17.9l-.2-.2c-.2-.2-.6-.4-1.1-.8-1-.8-2.5-2-4.3-3.7-3.6-3.3-8.5-8.1-13.3-14.3-5.5-7-10.7-15.4-14.2-24.7 24.9-29 39.6-64.7 39.6-103.4.0-92.8-84.9-168.9-192.6-175.5.4 5.1.6 10.3.6 15.5z"/></svg></span>
Hide Comments</button></div></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div id=stickySideBar class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#pre-requisites>Pre-requisites</a></li><li><a href=#testing-sr-iov>Testing SR-IOV</a></li><li><a href=#automating-the-virtual-function-generation>Automating the virtual function generation</a></li><li><a href=#autostarting-the-network-cards>Autostarting the Network Cards</a></li><li><a href=#assign-virtual-functions-to-vms>Assign Virtual Functions to VMs</a></li><li><a href=#windows-hosts>Windows hosts</a></li><li><a href=#done>Done!</a></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=/tags/dell target=_blank>Dell</a></li><li class=list-inline-item><a href=/tags/intel target=_blank>Intel</a></li><li class=list-inline-item><a href=/tags/nic target=_blank>NIC</a></li><li class=list-inline-item><a href=/tags/linux target=_blank>Linux</a></li><li class=list-inline-item><a href=/tags/windows target=_blank>Windows</a></li><li class=list-inline-item><a href=/tags/proxmox target=_blank>Proxmox</a></li><li class=list-inline-item><a href=/tags/bash target=_blank>Bash</a></li><li class=list-inline-item><a href=/tags/iommu target=_blank>IOMMU</a></li><li class=list-inline-item><a href=/tags/passthrough target=_blank>Passthrough</a></li></ul></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=Enabling%20SR-IOV%20for%20an%20Intel%20X540-T2%20on%20Proxmox%208&url=https%3a%2f%2fkovasky.me%2fblogs%2fsr_iov%2f"><span class="icon fab fa-twitter"><svg viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=Enabling%20SR-IOV%20for%20an%20Intel%20X540-T2%20on%20Proxmox%208: https%3a%2f%2fkovasky.me%2fblogs%2fsr_iov%2f"><span class="icon fab fa-whatsapp"><svg viewBox="0 0 448 512"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></span></a></li><li class="list-inline-item text-center"><a target=_blank href='mailto:?subject=Enabling%20SR-IOV%20for%20an%20Intel%20X540-T2%20on%20Proxmox%208&amp;body=Check%20out%20this%20site https%3a%2f%2fkovasky.me%2fblogs%2fsr_iov%2f'><span class="icon fa fa-envelope"><svg viewBox="0 0 512 512"><path d="M48 64C21.5 64 0 85.5.0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4.0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4.0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3.0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8.0L0 176z"/></svg></span></a></li></ul></div></aside></div></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<span class="icon fas fa-angle-up"><svg viewBox="0 0 448 512"><path d="M201.4 137.4c12.5-12.5 32.8-12.5 45.3.0l160 160c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L224 205.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3.0s-12.5-32.8.0-45.3l160-160z"/></svg></span></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}let stickySideBarElem=document.getElementById("stickySideBar"),stickyNavBar="true";if(stickyNavBar){let e=document.getElementById("profileHeader"),t=e.offsetHeight+15;stickySideBarElem.style.top=t+"px"}else stickySideBarElem.style.top="50px"</script><script>function toggleComments(){var e,t,n,s,o=document.getElementById("cusdis_thread");o.style.display=o.style.display==="flex"?"none":"flex",t=document.getElementById("load_comments"),t.style.display=t.style.display==="block"?"none":"block",n=document.getElementById("comments_header"),n.style.display=n.style.display==="block"?"none":"block",s=document.getElementById("hide_comments"),s.style.display=s.style.display==="block"?"none":"block",e=document.getElementById("cusdis_script"),e===null&&(e=document.createElement("script"),e.src="https://cusdis.com/js/cusdis.es.js",e.async=!1,e.defer=!1,e.id="cusdis_script",document.body.appendChild(e))}</script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script><script>kofiWidgetOverlay.draw("kovasky",{type:"floating-chat","floating-chat.donateButton.text":"Support me","floating-chat.donateButton.background-color":"#f45d22","floating-chat.donateButton.text-color":"#fff"})</script></div><footer><div class="container py-3" id=recent-posts><div class="h3 text-center text-secondary py-3">Recent Posts</div><div class="row justify-content-center"><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/ubuntu_virtual_monitor/><img loading=lazy src=https://kovasky.me/blogs/ubuntu_virtual_monitor/images/nvidia_x_settings.webp class=card-img-top alt="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/ubuntu_virtual_monitor/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Configure a Virtual Display for Sunshine using Ubuntu on Xorg with Nvidia">Configure a Virtual â€¦</h5></a><div class="card-text secondary-font"><p>Intro I was tired of playing around with streaming settings that never quite fit my phone&rsquo;s display perfectly. I wanted to maximize the resolution and refresh rate a la Apollo, which sets up virtual displays automatically for each client but is Windows only. After some trial and error, I â€¦</p></div></div><div class="mt-auto card-footer"><span class=float-start>Nov 10, 2025</span>
<a href=/blogs/ubuntu_virtual_monitor/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/pfsense_haproxy_authelia/><img loading=lazy src=https://kovasky.me/blogs/pfsense_haproxy_authelia/images/authelia_login.webp class=card-img-top alt="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/pfsense_haproxy_authelia/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Configure HAProxy with Authelia on pfSense">Configure HAProxy with â€¦</h5></a><div class="card-text secondary-font"><p>Intro Some of my hosted services do not have OIDC support or any sort of authentication out of the box. Since I am already running an instance of Authelia, I decided to use it to secure those services. It was not as straight forward as I thought, specially using HAProxy on pfSense. There are a few â€¦</p></div></div><div class="mt-auto card-footer"><span class=float-start>Aug 18, 2025</span>
<a href=/blogs/pfsense_haproxy_authelia/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/pfsense_fail2ban/><img loading=lazy src=https://kovasky.me/blogs/pfsense_fail2ban/images/pfsense_alias.webp class=card-img-top alt="Enabling SR-IOV for an Intel X540-T2 on Proxmox 8"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/pfsense_fail2ban/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Connect Fail2Ban with pfSense">Connect Fail2Ban with â€¦</h5></a><div class="card-text secondary-font"><p>Intro Some of my self-hosted services don&rsquo;t play nicely with Cloudflare proxying. This has led me to use DNS and forgo Cloudflare&rsquo;s protection. Many of the guides out there require pfBlockerNG or the use of scripts that authenticate to pfSense via SSH. This guide will help you integrate â€¦</p></div></div><div class="mt-auto card-footer"><span class=float-start>Aug 3, 2025</span>
<a href=/blogs/pfsense_fail2ban/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div></div></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/kovasky aria-label=github><svg width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg>
</a></span><span class=px-1><a href=https://www.linkedin.com/in/kovaskybuezo/ aria-label=linkedin><svg width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg></a></span></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://kovasky.me/ title="Kovasky Buezo | Software Developer, Cybersecurity Enthusiast"><img alt="Footer logo" src=/fav.ico height=40px width=40px></a></div>&copy; 2025 All rights reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;</span></div></div></div></div></footer><script>document.body.className.includes("light")&&(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))</script><script async data-domain=kovasky.me src=https://plausible.agrajag.cloud/js/script.js></script><section id=search-content class=py-2><div class=container id=search-results></div></section></body></html>